<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta charset="utf-8" />
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<title>python3 use math.sqrt(), results are up and down, which is unexpected</title>
	</head>
<body>
<h2>python3 use math.sqrt(), results are up and down, which is unexpected</h2>

<p>First, I was learning calculus limitation when I find a limitation difficult , so I use python3 to calculate approximate solution. THEN, the terrible thing happened.</p>

<hr />

<p>The limitation: </p>

<figure><img src="equation.png"/></figure>

<p>finally， I solve it in math, the result is 3</p>

<p>So, the ideal approximate solution is 3.</p>

<p>Ok, let’s see the simulation (use jupyter-lab):</p>

<pre><code class="code-highlighted code-python"><span class="syntax-all syntax-keyword">%</span>matplotlib
<span class="syntax-all syntax-keyword">import</span> math
<span class="syntax-all syntax-keyword">from</span> matplotlib <span class="syntax-all syntax-keyword">import</span> pyplot <span class="syntax-all syntax-keyword">as</span> plt
<span class="syntax-all syntax-constant">N</span> <span class="syntax-all syntax-keyword">=</span> <span class="syntax-all syntax-constant">100</span>
x <span class="syntax-all syntax-keyword">=</span> []
y <span class="syntax-all syntax-keyword">=</span> []
<span class="syntax-all syntax-keyword">for</span> i <span class="syntax-all syntax-keyword">in</span> <span class="syntax-all syntax-constant">range</span>(<span class="syntax-all syntax-constant">0</span>,<span class="syntax-all syntax-constant">N</span>,<span class="syntax-all syntax-constant">1</span>):
    tmp <span class="syntax-all syntax-keyword">=</span> <span class="syntax-all syntax-keyword">-</span> <span class="syntax-all syntax-constant">1</span><span class="syntax-all syntax-keyword">&lt;&lt;</span>i
    x.append(tmp)
    y.append(math.sqrt((<span class="syntax-all syntax-constant">4</span><span class="syntax-all syntax-keyword">*</span>tmp<span class="syntax-all syntax-keyword">**</span><span class="syntax-all syntax-constant">2</span><span class="syntax-all syntax-keyword">-</span><span class="syntax-all syntax-constant">8</span><span class="syntax-all syntax-keyword">*</span>tmp<span class="syntax-all syntax-keyword">+</span><span class="syntax-all syntax-constant">5</span>))<span class="syntax-all syntax-keyword">+</span><span class="syntax-all syntax-constant">2</span><span class="syntax-all syntax-keyword">*</span>tmp<span class="syntax-all syntax-keyword">+</span><span class="syntax-all syntax-constant">1</span>)
plt.plot(<span class="syntax-all syntax-constant">range</span>(<span class="syntax-all syntax-constant">N</span>),y)
plt.show()</code></pre>

<figure><img src="Figure_1.png"/></figure>

<p>In x=2^53, math.sqrt() results is unexpected, </p>

<hr />

<p>Then, I simulate more meticulous. (Use Jupiter-lab)</p>

<pre><code class="code-highlighted code-python"><span class="syntax-all syntax-keyword">%</span>matplotlib
<span class="syntax-all syntax-keyword">import</span> math
<span class="syntax-all syntax-keyword">from</span> matplotlib <span class="syntax-all syntax-keyword">import</span> pyplot <span class="syntax-all syntax-keyword">as</span> plt
<span class="syntax-all syntax-constant">N</span> <span class="syntax-all syntax-keyword">=</span> <span class="syntax-all syntax-constant">100</span>
x <span class="syntax-all syntax-keyword">=</span> []
y <span class="syntax-all syntax-keyword">=</span> []
<span class="syntax-all syntax-keyword">for</span> i <span class="syntax-all syntax-keyword">in</span> <span class="syntax-all syntax-constant">range</span>(<span class="syntax-all syntax-keyword">-</span><span class="syntax-all syntax-constant">N</span>,<span class="syntax-all syntax-constant">N</span>,<span class="syntax-all syntax-constant">1</span>):
    tmp <span class="syntax-all syntax-keyword">=</span> <span class="syntax-all syntax-keyword">-</span> (<span class="syntax-all syntax-constant">1</span><span class="syntax-all syntax-keyword">&lt;&lt;</span><span class="syntax-all syntax-constant">53</span>)<span class="syntax-all syntax-keyword">+</span>i
    x.append(tmp)
    y.append(math.sqrt((<span class="syntax-all syntax-constant">4</span><span class="syntax-all syntax-keyword">*</span>tmp<span class="syntax-all syntax-keyword">**</span><span class="syntax-all syntax-constant">2</span><span class="syntax-all syntax-keyword">-</span><span class="syntax-all syntax-constant">8</span><span class="syntax-all syntax-keyword">*</span>tmp<span class="syntax-all syntax-keyword">+</span><span class="syntax-all syntax-constant">5</span>))<span class="syntax-all syntax-keyword">+</span><span class="syntax-all syntax-constant">2</span><span class="syntax-all syntax-keyword">*</span>tmp<span class="syntax-all syntax-keyword">+</span><span class="syntax-all syntax-constant">1</span>)
plt.scatter(<span class="syntax-all syntax-constant">range</span>(<span class="syntax-all syntax-constant">2</span><span class="syntax-all syntax-keyword">*</span><span class="syntax-all syntax-constant">N</span>),y)
plt.show()</code></pre>

<figure><img src="Figure_2.png"/></figure>

<p>Yes, the results are up and down, so strange</p>

<hr />

<p>THEN, I use Newton&#39;s Iterative Root-Finding Method instead of math.sqrt()</p>

<p>But ,the result is similar</p>

<pre><code class="code-highlighted code-python"><span class="syntax-all syntax-keyword">def</span> <span class="syntax-all syntax-entity">newton_sqrt</span>(<span class="syntax-all syntax-parameter">n</span>):
    root <span class="syntax-all syntax-keyword">=</span> n <span class="syntax-all syntax-keyword">/</span> <span class="syntax-all syntax-constant">2</span>
    <span class="syntax-all syntax-keyword">for</span> k <span class="syntax-all syntax-keyword">in</span> <span class="syntax-all syntax-constant">range</span>(<span class="syntax-all syntax-constant">200</span>):
        root <span class="syntax-all syntax-keyword">=</span> (<span class="syntax-all syntax-constant">1</span> <span class="syntax-all syntax-keyword">/</span> <span class="syntax-all syntax-constant">2</span>) <span class="syntax-all syntax-keyword">*</span> (root <span class="syntax-all syntax-keyword">+</span> n <span class="syntax-all syntax-keyword">/</span> root)
    <span class="syntax-all syntax-keyword">return</span> root

<span class="syntax-all syntax-constant">N</span> <span class="syntax-all syntax-keyword">=</span> <span class="syntax-all syntax-constant">100</span>
x <span class="syntax-all syntax-keyword">=</span> []
y <span class="syntax-all syntax-keyword">=</span> []
<span class="syntax-all syntax-keyword">for</span> i <span class="syntax-all syntax-keyword">in</span> <span class="syntax-all syntax-constant">range</span>(<span class="syntax-all syntax-keyword">-</span><span class="syntax-all syntax-constant">N</span>,<span class="syntax-all syntax-constant">N</span>,<span class="syntax-all syntax-constant">1</span>):
    tmp <span class="syntax-all syntax-keyword">=</span> <span class="syntax-all syntax-keyword">-</span> (<span class="syntax-all syntax-constant">1</span><span class="syntax-all syntax-keyword">&lt;&lt;</span><span class="syntax-all syntax-constant">53</span>)<span class="syntax-all syntax-keyword">+</span>i
    x.append(tmp)
    y.append(newton_sqrt((<span class="syntax-all syntax-constant">4</span><span class="syntax-all syntax-keyword">*</span>tmp<span class="syntax-all syntax-keyword">**</span><span class="syntax-all syntax-constant">2</span><span class="syntax-all syntax-keyword">-</span><span class="syntax-all syntax-constant">8</span><span class="syntax-all syntax-keyword">*</span>tmp<span class="syntax-all syntax-keyword">+</span><span class="syntax-all syntax-constant">5</span>))<span class="syntax-all syntax-keyword">+</span><span class="syntax-all syntax-constant">2</span><span class="syntax-all syntax-keyword">*</span>tmp<span class="syntax-all syntax-keyword">+</span><span class="syntax-all syntax-constant">1</span>)
plt.scatter(<span class="syntax-all syntax-constant">range</span>(<span class="syntax-all syntax-constant">2</span><span class="syntax-all syntax-keyword">*</span><span class="syntax-all syntax-constant">N</span>),y)
plt.show()  </code></pre>

<figure><img src="Figure_3.png"/></figure>

<hr />

<p>Finally, I want to know WHY? Why the results is unexpeted WHEN the abs(x) is more than 2^53?</p>

<p>THANKs.</p>

</body>
</html>

